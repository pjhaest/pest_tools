
import pest_tools as pt

# Load jco, parameter names, observation names
jco_df, par_names, obs_names = pt.load_jco('example.jco')

# Load dictionary of parameters
pars_dict = pt.load_pars('example.pst')

# Load dictionary of observations
obs_dict = pt.load_obs('example.pst')


#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
## Get Parameter Sensitivities
#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

par_sen = pt.ParSen(jco_df, obs_dict, pars_dict)

#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
# Get Observation Sensitivities
#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

ob_sen = pt.ObSen(jco_df, obs_dict)

#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
## Parameter Summaries and Plots
#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
#------------------------------------------------------------------------------
## Get list of n_head most sensitive parameters
#------------------------------------------------------------------------------
'''
par_sen.head(20)
'''
#------------------------------------------------------------------------------
## Get list of n_tail least sensitive parameters
#------------------------------------------------------------------------------
'''
par_sen.tail(20)
'''
#------------------------------------------------------------------------------
## Gen sensitivity of a single parameter
#------------------------------------------------------------------------------
'''
par_sen.par('kx_cms005')
'''
#------------------------------------------------------------------------------
## Plot the n most sensitive parameters
## Negative values will plot the n lest sensitive parameters
## if n not defined defaults to all parameters
#------------------------------------------------------------------------------
'''
par_sen.plot(n = 20) # Most Sensitive
par_sen.plot(n = -20) # Least Sensitive
par_sen.plot() # All
'''
#------------------------------------------------------------------------------
## Plot sensitivies of an individual parameter group, optionally limit to n values
#------------------------------------------------------------------------------
'''
par_sen.plot(group = 'riv_kz', n = 30)
'''
#------------------------------------------------------------------------------
## Plot the sum of Sensitivity for each paramter group
#------------------------------------------------------------------------------
'''
par_sen.plot_sum_group()
'''

#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
## Observation Summaries and Plots
#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
#------------------------------------------------------------------------------
## Get list of n_head most sensitive observations
#------------------------------------------------------------------------------
'''
ob_sen.head(20)
'''
#------------------------------------------------------------------------------
## Get list of n_tail least sensitive observations
#------------------------------------------------------------------------------
'''
ob_sen.tail(20)
'''
#------------------------------------------------------------------------------
## Gen sensitivity of a single observation
#------------------------------------------------------------------------------
'''
ob_sen.ob('cwi_109663')
'''
#------------------------------------------------------------------------------
# Plot most n sensitive obs
#------------------------------------------------------------------------------
'''
ob_sen.plot(n=20)
'''
#------------------------------------------------------------------------------
## Plot sensitivies of an individual observation group, optionally limit to n values
#------------------------------------------------------------------------------
'''
ob_sen.plot(group = 'cwi', n = 15)
ob_sen.plot(group = 'obwell', n = 15)
'''
#------------------------------------------------------------------------------
## Plot the sum of Sensitivity for each observation group
#------------------------------------------------------------------------------
'''
ob_sen.plot_sum_group()
'''


